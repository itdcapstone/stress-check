<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Boxicons -->
    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <!-- My CSS -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='client_styles/result.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='client_styles/alert_styles.css') }}">
  
    

    <title>Stress Test Results</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <!-- html2canvas Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- jsPDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
     
    <title>Assessment Result</title>
</head>

<body>

       <!-- SIDEBAR -->
       <section id="sidebar">
        <a href="#" class="brand">
			<i class='bx bx-badge-check'></i>
            <span class="text">Stress Check</span>
        </a>
        <ul class="side-menu top">
            <li>
                <a href="{{ url_for('dashboard', username=username) }}">
                    <i class='bx bxs-dashboard' ></i>
                    <span class="text">Dashboard</span>
                </a>
            </li>
            <li>
                <a href="{{ url_for('analytics') }}">
                    <i class='bx bxs-doughnut-chart' ></i>
                    <span class="text">History</span>
                </a>
            </li>
			<li class="active">
                <a href="{{ url_for('recommendation') }}">
					<i class='bx bxs-message-rounded-dots'></i>
                    <span class="text">Recommendation</span>
                </a>
            </li>
			<li>
                <a href="{{ url_for('profile') }}">
                    <i class='bx bxs-user-circle' ></i>
                    <span class="text">My Profile</span>
                </a>
            </li>
            <li>
                <a href="{{ url_for('faqs') }}">
                    <i class='bx bx-question-mark'></i>
                    <span class="text">FAQ's</span>
                </a>
            </li>
        </ul>
        <ul class="side-menu">
			<li>
                <a href="{{ url_for('feedback') }}">
                    <i class='bx bxs-user-pin'></i>
                    <span class="text">Feedback</span>
                </a>
            </li>
            <li>
                <a href="{{ url_for('logout') }}" class="logout">
                    <i class='bx bxs-log-out-circle' ></i>
                    <span class="text">Logout</span>
                </a>
            </li>
        </ul>
		<img src="{{ url_for('static', filename='assets/plants.png') }}" alt="Image Description">
    </section>
    <!-- SIDEBAR -->

    <!-- CONTENT -->
    <section id="content">
        <!-- NAVBAR -->
        <nav>
            <i class='bx bx-menu' ></i>
            <form action="#">
        </nav>
        <!-- NAVBAR -->

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div id="flash-messages">
            {% for category, message in messages %}
            <div class="custom-alert {% if category == 'error' %}error-alert{% else %}success-alert{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
            </div>
        {% endif %}
        {% endwith %}

        
        <div class="result-container" id="pdf-content">
            
            <h1>Your Stress Test Results</h1>

            <div class="test-info">
                <p><strong>Test-Taker: {{ username }}</strong> <span id="test-taker-name"></span></p>
                <p><strong>Date:</strong> <span id="test-date"></span></p>
            </div>
            
    
            <!-- Progress Circle for Stress Level -->
            <div class="progress-container">
                <svg viewBox="0 0 200 200" width="200" height="200">
                    <!-- Background Circle -->
                    <circle class="progress-background" cx="100" cy="100" r="90" stroke-width="12" />
                    <!-- Progress Circle -->
                    <circle class="progress-circle" cx="100" cy="100" r="90" stroke-width="12" stroke-dasharray="565.48" stroke-dashoffset="100" />
                </svg>
                <div class="progress-text">
                    <h2 id="progress-number">{{ predicted_stress_level }}</h2>
                    <p>Stress Level / 5</p>
                </div>
            </div>

           <!-- Flow of Questionnaire Responses -->
            <div class="flow-responses">
                <div class="btn-pdf">
                    <div class="no-pdf">
                        <a href="#" class="cta-btn" onclick="generatePDF()">Generate PDF</a>
                    </div>
                </div>
           

                {% for question_id, response in responses.items() %}
                <div class="flow-card" data-response="{{ response }}" data-context="{{ question_id }}">
                    <div class="flow-card-content">
                        <h4>
                            <!-- Dynamic Question Display based on new IDs -->
                            {% if question_id == "6735a37be761ac9bd6d7abf2" %}
                            Do you often experience feelings of sadness or depression related to your academic workload?
                            {% elif question_id == "6735a37ce761ac9bd6d7abf3" %}
                            How often do you feel anxious or worried about your academic performance?
                            {% elif question_id == "6735a37ce761ac9bd6d7abf4" %}
                            How often do you feel peer pressure affects your academic decisions?
                            {% elif question_id == "6735a37ce761ac9bd6d7abf5" %}
                            How often does poor sleep quality negatively impact your academic performance (e.g., due to insomnia or other sleep issues)?
                            {% elif question_id == "6735a37ce761ac9bd6d7abf6" %}
                            How often does your reliance on AI tools (e.g., chatbots, educational apps) for academic tasks cause you stress?
                            {% elif question_id == "6735a37ce761ac9bd6d7abf7" %}
                            How often do you feel stressed due to family-related issues?
                            {% elif question_id == "6735a37ce761ac9bd6d7abf8" %}
                            How satisfied are you with your current financial situation as a student?
                            {% elif question_id == "6735a37ce761ac9bd6d7abf9" %}
                            I feel that I can rely on my friends when I need help.
                            {% elif question_id == "6735a37ce761ac9bd6d7abfa" %}
                            How would you rate your access to resources (e.g., textbooks, technology) necessary for your academic success?
                            {% elif question_id == "6735a37ce761ac9bd6d7abfb" %}
                            I often feel stressed because I am unable to get proper rest at home.
                            {% elif question_id == "6735a37ce761ac9bd6d7abfc" %}
                            Long commutes due to traffic congestion add to my daily stress.
                            {% elif question_id == "6735a37ce761ac9bd6d7abfd" %}
                            How do you feel about the noise level in your living environment during study hours?
                            {% elif question_id == "6735a37ce761ac9bd6d7abfe" %}
                            Extreme weather conditions (too hot or too cold) make it difficult for me to focus on my studies.
                            {% elif question_id == "6735a37ce761ac9bd6d7abff" %}
                            Do you feel confident in your program choice?
                            {% elif question_id == "6735a37ce761ac9bd6d7ac00" %}
                            How would you rate your level of stress related to academic demands such as exams, assignments, and deadlines?
                            {% elif question_id == "6735a37ce761ac9bd6d7ac01" %}
                            Do you feel supported by your academic advisors or mentors in managing stress related to your studies?
                            {% else %}
                            Question not available
                            {% endif %}
                        </h4>
                        <p>{{ response }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        
    
            <h3>Common Stressors</h3>
            {% if common_stressors %}
                <ul class="stressors-list">
                    <div class="stressors-container">
                        {% for stressor in common_stressors %}
                            <div class="stressor-item {{ stressor.class }}">
                                <i class="{{ stressor.icon }}"></i> 
                                <span class="stressor-name">{{ stressor.name }}</span>
                            </div>
                        {% endfor %}
                    </div>
                    
                </ul>
            {% else %}
                <p>No significant stressors identified.</p>
            {% endif %}

            <div class="btn-pdf">
                <div class="no-pdf">
                    <a href="#" class="cta-btn" onclick="generatePDF()">Generate PDF</a>
                </div>
            </div>
    
        </div>
                
    <script src="{{ url_for('static', filename='user_scripts/result.js') }}"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    

</body>
</html>